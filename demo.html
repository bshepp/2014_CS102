<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Interactive N-Dimensional Geometry Engine - Transform CS102 sphere calculations into infinite dimensions with AI-powered natural language queries">
    <meta name="keywords" content="geometry, n-dimensional, hypersphere, mathematics, education, CS102">
    <meta name="author" content="N-Dimensional Geometry Engine Team">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="N-Dimensional Geometry Engine">
    <meta property="og:description" content="Interactive geometry calculator supporting 1D to 100D+ shapes with AI assistance">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://gengine.darkforestlabs.com">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="N-Dimensional Geometry Engine">
    <meta name="twitter:description" content="Interactive geometry calculator supporting 1D to 100D+ shapes">
    <title>N-Dimensional Geometry Engine - Interactive Demo</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .status-banner {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid #4CAF50;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .status-banner.error {
            background: rgba(244, 67, 54, 0.2);
            border-color: #f44336;
        }
        
        .demo-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .panel {
            background: rgba(255,255,255,0.15);
            border-radius: 15px;
            padding: 25px;
            /* backdrop-filter: blur(10px); */
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        
        .panel h2 {
            margin-bottom: 20px;
            font-size: 1.5em;
            color: #fff;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .input-group input, .input-group select, .input-group textarea {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 5px;
            background: rgba(255,255,255,0.2);
            color: white;
            font-size: 16px;
        }
        
        .input-group input::placeholder, .input-group textarea::placeholder {
            color: rgba(255,255,255,0.7);
        }
        
        .btn {
            background: #4CAF50;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn:hover {
            background: #45a049;
            transform: translateY(-2px);
        }
        
        .btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: #2196F3;
        }
        
        .btn-secondary:hover {
            background: #1976D2;
        }
        
        .btn-warning {
            background: #FF9800;
        }
        
        .btn-warning:hover {
            background: #F57C00;
        }
        
        .result {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .visualization-panel {
            grid-column: 1 / -1;
            text-align: center;
        }
        
        .dimension-slider {
            margin: 20px 0;
        }
        
        .dimension-slider input[type="range"] {
            width: 100%;
            height: 10px;
            background: rgba(255,255,255,0.3);
            border-radius: 5px;
            outline: none;
        }
        
        .dimension-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .info-card {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .info-card h3 {
            margin-bottom: 10px;
            color: #4CAF50;
        }
        
        .info-card .value {
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            font-style: italic;
        }
        
        .error {
            background: rgba(255,0,0,0.3);
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
        }
        
        @media (max-width: 768px) {
            .demo-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header" role="banner">
            <h1>üåå N-Dimensional Geometry Engine</h1>
            <p>Interactive Demo - Powered by MCP Server</p>
        </header>

        <div id="statusBanner" class="status-banner">
            üîÑ Checking MCP server connection...
        </div>
        
        <main class="demo-grid" role="main">
            <!-- Hypersphere Calculator Panel -->
            <div class="panel">
                <h2>üîÆ N-Dimensional Hypersphere</h2>
                <div class="input-group">
                    <label for="sphereDimensions">Dimensions (1-100):</label>
                    <input type="number" id="sphereDimensions" min="1" max="100" value="3" aria-label="Number of dimensions for the hypersphere" />
                </div>
                <div class="input-group">
                    <label for="sphereRadius">Radius:</label>
                    <input type="number" id="sphereRadius" min="0.1" step="0.1" value="1.0" aria-label="Radius of the hypersphere" />
                </div>
                <button class="btn" onclick="calculateHypersphere()" aria-label="Calculate hypersphere properties">Calculate Hypersphere</button>
                <div id="sphereResult" class="result" style="display: none;"></div>
            </div>
            
            <!-- Hypercube Calculator Panel -->
            <div class="panel">
                <h2>üì¶ N-Dimensional Hypercube</h2>
                <div class="input-group">
                    <label for="cubeDimensions">Dimensions (1-100):</label>
                    <input type="number" id="cubeDimensions" min="1" max="100" value="3" aria-label="Number of dimensions for the hypercube" />
                </div>
                <div class="input-group">
                    <label for="cubeSide">Side Length:</label>
                    <input type="number" id="cubeSide" min="0.1" step="0.1" value="1.0" aria-label="Side length of the hypercube" />
                </div>
                <button class="btn" onclick="calculateHypercube()" aria-label="Calculate hypercube properties">Calculate Hypercube</button>
                <div id="cubeResult" class="result" style="display: none;"></div>
            </div>
            
            <!-- Shape Comparison Panel -->
            <div class="panel">
                <h2>‚öñÔ∏è Compare Shapes</h2>
                <div class="input-group">
                    <label for="compareDimensions">Dimensions:</label>
                    <input type="number" id="compareDimensions" min="1" max="100" value="4" aria-label="Dimensions for shape comparison" />
                </div>
                <div class="input-group">
                    <label for="compareSize">Size (radius/side):</label>
                    <input type="number" id="compareSize" min="0.1" step="0.1" value="2.0" aria-label="Size parameter for shapes" />
                </div>
                <button class="btn btn-secondary" onclick="compareShapes()" aria-label="Compare hypersphere and hypercube">Compare Shapes</button>
                <div id="compareResult" class="result" style="display: none;"></div>
            </div>
            
            <!-- Usage Statistics Panel -->
            <div class="panel">
                <h2>üìä Server Statistics</h2>
                <div class="input-group">
                    <label for="statsDays">Days to analyze:</label>
                    <input type="number" id="statsDays" min="1" max="30" value="7" aria-label="Number of days for statistics" />
                </div>
                <button class="btn btn-warning" onclick="getUsageStatistics()" aria-label="Get server usage statistics">Get Statistics</button>
                <div id="statsResult" class="result" style="display: none;"></div>
            </div>
            
            <!-- Batch Calculations Panel -->
            <div class="panel visualization-panel">
                <h2>üöÄ Dimension Scaling Analysis</h2>
                <div class="input-group">
                    <label for="scalingShape">Shape Type:</label>
                    <select id="scalingShape" aria-label="Shape type for scaling analysis">
                        <option value="hypersphere">Hypersphere</option>
                        <option value="hypercube">Hypercube</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="scalingProperty">Property to Analyze:</label>
                    <select id="scalingProperty" aria-label="Property for scaling analysis">
                        <option value="volume">Volume</option>
                        <option value="surface_area">Surface Area</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="scalingMaxDim">Maximum Dimension:</label>
                    <input type="number" id="scalingMaxDim" min="2" max="20" value="10" aria-label="Maximum dimension for analysis" />
                </div>
                <button class="btn btn-secondary" onclick="analyzeDimensionScaling()" aria-label="Analyze dimension scaling">Analyze Scaling</button>
                <div id="scalingVisualization" style="margin-top: 20px;" role="img" aria-label="Dimension scaling visualization"></div>
            </div>
        </main>
        
        <!-- Quick Info Panel -->
        <div class="panel">
            <h2>‚ÑπÔ∏è MCP Server Information</h2>
            <p>This interface connects to the GeometryOracle MCP Server deployed on AWS Lambda.</p>
            <p><strong>Available Tools:</strong></p>
            <ul style="list-style: none; padding-left: 0;">
                <li>‚úÖ calculate_hypersphere - N-dimensional sphere calculations</li>
                <li>‚úÖ calculate_hypercube - N-dimensional cube calculations</li>
                <li>‚úÖ compare_shapes - Compare different geometric shapes</li>
                <li>‚úÖ get_usage_statistics - Server usage analytics</li>
                <li>‚úÖ batch_geometry_calculations - Process multiple shapes</li>
                <li>‚úÖ analyze_dimension_scaling - Analyze property scaling</li>
            </ul>
            <p style="margin-top: 15px;"><small>MCP Endpoint: <code id="mcpEndpoint">Loading...</code></small></p>
        </div>
    </div>
    
    <script>
        // MCP Server configuration
        const MCP_ENDPOINT = window.location.hostname === 'localhost' 
            ? 'http://localhost:8000/mcp'  // For local testing with a proxy
            : 'https://s6ngc23inj.execute-api.us-east-1.amazonaws.com/prod/mcp';
        
        let requestId = 1;

        // Initialize and check server status
        window.addEventListener('DOMContentLoaded', async () => {
            document.getElementById('mcpEndpoint').textContent = MCP_ENDPOINT;
            await checkServerStatus();
            document.getElementById('dimSlider').addEventListener('input', updateDimensionComparison);
            updateDimensionComparison();
        });

        // Check MCP server status
        async function checkServerStatus() {
            const statusBanner = document.getElementById('statusBanner');
            try {
                const response = await fetch(MCP_ENDPOINT, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    statusBanner.innerHTML = `‚úÖ MCP Server Connected - Version ${data.version || '1.0.0'}`;
                    statusBanner.classList.remove('error');
                } else {
                    throw new Error('Server not responding');
                }
            } catch (error) {
                statusBanner.innerHTML = '‚ö†Ô∏è MCP Server Offline - Some features may be unavailable';
                statusBanner.classList.add('error');
                console.error('Server check failed:', error);
            }
        }

        // Generic MCP tool caller
        async function callMCPTool(toolName, args) {
            const response = await fetch(MCP_ENDPOINT, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify({
                    jsonrpc: '2.0',
                    method: 'tools/call',
                    params: {
                        name: toolName,
                        arguments: args
                    },
                    id: requestId++
                })
            });

            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }

            const data = await response.json();
            
            if (data.error) {
                throw new Error(data.error.message || 'Unknown error');
            }
            
            return data.result;
        }

        // Calculate Hypersphere
        async function calculateHypersphere() {
            const dimensions = parseInt(document.getElementById('sphereDimensions').value);
            const radius = parseFloat(document.getElementById('sphereRadius').value);
            const resultDiv = document.getElementById('sphereResult');
            
            try {
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = '<div class="loading">Calculating hypersphere properties...</div>';
                
                const result = await callMCPTool('calculate_hypersphere', {
                    dimensions: dimensions,
                    radius: radius
                });
                
                resultDiv.innerHTML = `üîÆ Hypersphere Results
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Dimensions: ${result.dimensions}D
Radius: ${result.radius}
Diameter: ${result.diameter}

Volume: ${result.volume.toExponential(4)}
Surface Area: ${result.surface_area.toExponential(4)}

${getDimensionName(result.dimensions)}`;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }

        // Calculate Hypercube
        async function calculateHypercube() {
            const dimensions = parseInt(document.getElementById('cubeDimensions').value);
            const sideLength = parseFloat(document.getElementById('cubeSide').value);
            const resultDiv = document.getElementById('cubeResult');
            
            try {
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = '<div class="loading">Calculating hypercube properties...</div>';
                
                const result = await callMCPTool('calculate_hypercube', {
                    dimensions: dimensions,
                    side_length: sideLength
                });
                
                resultDiv.innerHTML = `üì¶ Hypercube Results
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Dimensions: ${result.dimensions}D
Side Length: ${result.side_length}

Volume: ${result.volume.toExponential(4)}
Surface Area: ${result.surface_area.toExponential(4)}
Vertices: ${result.vertices}
Edges: ${result.edges}
Diagonal: ${result.diagonal.toFixed(4)}

${getDimensionName(result.dimensions, 'cube')}`;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }

        // Compare Shapes
        async function compareShapes() {
            const dimensions = parseInt(document.getElementById('compareDimensions').value);
            const size = parseFloat(document.getElementById('compareSize').value);
            const resultDiv = document.getElementById('compareResult');
            
            try {
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = '<div class="loading">Comparing shapes...</div>';
                
                const result = await callMCPTool('compare_shapes', {
                    shapes: [
                        {type: 'hypersphere', dimensions: dimensions, radius: size},
                        {type: 'hypercube', dimensions: dimensions, side_length: size}
                    ]
                });
                
                const sphere = result.shapes[0];
                const cube = result.shapes[1];
                const comparison = result.comparison;
                
                resultDiv.innerHTML = `‚öñÔ∏è Shape Comparison (${dimensions}D)
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üîÆ Hypersphere (r=${size})
  Volume: ${sphere.volume.toExponential(4)}
  Surface: ${sphere.surface_area.toExponential(4)}

üì¶ Hypercube (s=${size})
  Volume: ${cube.volume.toExponential(4)}
  Surface: ${cube.surface_area.toExponential(4)}

üìä Comparison:
  Volume Ratio: ${comparison.volume_ratio.toFixed(4)}
  Surface Ratio: ${comparison.surface_area_ratio.toFixed(4)}
  Larger Volume: ${comparison.larger_volume}`;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }

        // Get Usage Statistics
        async function getUsageStatistics() {
            const days = parseInt(document.getElementById('statsDays').value);
            const resultDiv = document.getElementById('statsResult');
            
            try {
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = '<div class="loading">Fetching usage statistics...</div>';
                
                const result = await callMCPTool('get_usage_statistics', {
                    days: days
                });
                
                resultDiv.innerHTML = `üìä Usage Statistics (Last ${days} Days)
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Total Queries: ${result.total_queries}
Unique Sessions: ${result.unique_sessions}
Average per Day: ${result.average_queries_per_day.toFixed(1)}

Most Used Tools:
${Object.entries(result.tool_usage)
    .sort((a, b) => b[1] - a[1])
    .map(([tool, count]) => `  ‚Ä¢ ${tool}: ${count}`)
    .join('\n')}

Peak Hour: ${result.peak_hour}
Response Time: ${result.average_response_time_ms.toFixed(0)}ms`;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }

        // Analyze Dimension Scaling
        async function analyzeDimensionScaling() {
            const shapeType = document.getElementById('scalingShape').value;
            const property = document.getElementById('scalingProperty').value;
            const maxDim = parseInt(document.getElementById('scalingMaxDim').value);
            const vizDiv = document.getElementById('scalingVisualization');
            
            try {
                vizDiv.innerHTML = '<div class="loading">Analyzing dimension scaling...</div>';
                
                const result = await callMCPTool('analyze_dimension_scaling', {
                    shape_type: shapeType,
                    property: property,
                    dimension_range: {start: 1, end: maxDim},
                    parameter_value: 1.0
                });
                
                // Create Plotly visualization
                const trace = {
                    x: result.dimensions,
                    y: result.values,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: `${property} scaling`,
                    line: {
                        color: '#4CAF50',
                        width: 3
                    },
                    marker: {
                        size: 8,
                        color: '#4CAF50'
                    }
                };
                
                const layout = {
                    title: `${shapeType} ${property} vs Dimension`,
                    xaxis: { 
                        title: 'Dimension',
                        gridcolor: 'rgba(255,255,255,0.2)'
                    },
                    yaxis: { 
                        title: property.replace('_', ' '),
                        type: result.scaling_type === 'exponential' ? 'log' : 'linear',
                        gridcolor: 'rgba(255,255,255,0.2)'
                    },
                    paper_bgcolor: 'rgba(0,0,0,0)',
                    plot_bgcolor: 'rgba(255,255,255,0.05)',
                    font: { color: 'white' },
                    height: 400
                };
                
                Plotly.newPlot(vizDiv, [trace], layout, {responsive: true});
                
                // Add scaling analysis below
                vizDiv.innerHTML += `
<div style="margin-top: 20px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 5px;">
    <strong>Scaling Analysis:</strong><br>
    ‚Ä¢ Type: ${result.scaling_type}<br>
    ‚Ä¢ Max at dimension ${result.max_dimension}: ${result.max_value.toExponential(2)}<br>
    ‚Ä¢ Min at dimension ${result.min_dimension}: ${result.min_value.toExponential(2)}<br>
    ‚Ä¢ Growth factor: ${result.growth_factor.toFixed(4)}x per dimension
</div>`;
            } catch (error) {
                vizDiv.innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }

        // Update dimension comparison slider
        function updateDimensionComparison() {
            const dimension = parseInt(document.getElementById('dimSlider').value);
            document.getElementById('dimValue').textContent = dimension;
            
            // Quick calculations for radius = 1
            const sphereVolume = calculateSphereVolume(dimension, 1);
            const cubeVolume = Math.pow(2, dimension); // side = 2 to match diameter
            
            document.getElementById('dimensionInfo').innerHTML = `
                <div class="info-card">
                    <h3>Hypersphere</h3>
                    <div class="value">${sphereVolume.toExponential(2)}</div>
                    <small>Volume (r=1)</small>
                </div>
                <div class="info-card">
                    <h3>Hypercube</h3>
                    <div class="value">${cubeVolume.toExponential(2)}</div>
                    <small>Volume (s=2)</small>
                </div>
                <div class="info-card">
                    <h3>Vertices</h3>
                    <div class="value">${Math.pow(2, dimension)}</div>
                    <small>Hypercube</small>
                </div>
                <div class="info-card">
                    <h3>Ratio</h3>
                    <div class="value">${(sphereVolume/cubeVolume).toFixed(4)}</div>
                    <small>Sphere/Cube</small>
                </div>
            `;
        }

        // Helper function to calculate sphere volume (simplified)
        function calculateSphereVolume(n, r) {
            const pi = Math.PI;
            let volume = Math.pow(r, n);
            
            if (n % 2 === 0) {
                // Even dimensions: œÄ^(n/2) / (n/2)!
                const k = n / 2;
                volume *= Math.pow(pi, k);
                for (let i = 1; i <= k; i++) {
                    volume /= i;
                }
            } else {
                // Odd dimensions: 2 * (2œÄ)^((n-1)/2) / n!!
                const k = (n - 1) / 2;
                volume *= 2 * Math.pow(2 * pi, k);
                let factorial = 1;
                for (let i = n; i > 0; i -= 2) {
                    factorial *= i;
                }
                volume /= factorial;
            }
            
            return volume;
        }

        // Get friendly dimension names
        function getDimensionName(dim, type = 'sphere') {
            const sphereNames = {
                1: '1D: Line Segment',
                2: '2D: Circle (Disk)',
                3: '3D: Sphere (Ball)',
                4: '4D: Hypersphere (3-sphere)',
                5: '5D: 4-sphere'
            };
            
            const cubeNames = {
                1: '1D: Line Segment',
                2: '2D: Square',
                3: '3D: Cube',
                4: '4D: Tesseract (8-cell)',
                5: '5D: Penteract'
            };
            
            const names = type === 'sphere' ? sphereNames : cubeNames;
            return names[dim] || `${dim}D: ${dim-1}-${type}`;
        }
    </script>
</body>
</html>